<section class="section bg-ai">
    <div class="container">
        <div class="flex flex-col">
            <div class="flex flex-col max-w-[628px] mx-auto">
                <div class="flex ">
                    <i class="AI-icon min-w-10 mr-1"></i>
                    <h1 class="text-Text font-medium tracking-12 text-h3 lg:text-h2Mob text-center"><span class="text-blue100">AI</span>-Powered Lawyer Matching:
                        Fast, Accurate, and Free</h1>
                </div>
                <span class="flex items-center gap-x-2 mx-auto my-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="47" height="3" viewBox="0 0 47 3" fill="none">
                          <path d="M2 1.5H45" stroke="#FFBF16" stroke-width="3" stroke-linecap="round"/>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="47" height="3" viewBox="0 0 47 3" fill="none">
                          <path d="M2 1.5H45" stroke="#FFBF16" stroke-width="3" stroke-linecap="round" stroke-dasharray="7 7"/>
                        </svg>
                    </span>
                <p class="text-center">Our AI-powered lawyer finder makes it easy to connect with the right attorney for your situation. Simply answer a few questions about your case.</p>
            </div>
            <div x-data="multiStepForm" class="w-full max-w-[720px] mx-auto bg-white p-6 mt-6 md:px-4 md:py-5 rounded-xl shadow-v1">
                <!-- Step 1 -->
                <div x-show="step === 1">
                    <div class="flex flex-col">
                        <div class="flex mb-6">
                            <i class="AI-icon-small min-w-[37px] mr-3 mt-1"></i>
                            <div class="flex flex-col">
                                <p class="text-base font-medium mb-2">Describe your problem.</p>
                                <p class="text-Grey">Briefly explain the legal situation you're facing!</p>
                            </div>
                        </div>
                        <label>
                            <textarea x-model="textInput" class="input steps mb-5" placeholder="Tell us what happened..."></textarea>
                        </label>
                        <p class="text-body2 text-Grey mb-5"><span class="font-bold">For example:</span> Delaware was the first state to officially ratify the United States Constitution in 1787. For this reason, Delaware considers itself "the first state." </p>
                        <button @click="handleSubmitStep1" class="button" aria-label="Get Started Button">
                            <span>Get Started</span>
                            <svg class="ml-2" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10" fill="none">
                                <path d="M4.88452 0.880859L9.19988 5.00007L4.88452 9.11928" stroke="white" stroke-width="1.28571" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Step 2 -->
                <div x-show="step === 2">
                    <div class="flex flex-col">
                        <div class="flex mb-6">
                            <i class="AI-icon-small min-w-[37px] mr-3 mt-1"></i>
                            <div class="flex flex-col">
                                <p class="text-base font-medium mb-2">Tell us how to reach you.</p>
                                <p class="text-Grey">Provide your contact details so we can connect you with the best lawyers.</p>
                            </div>
                        </div>
                        <div class="row gap-4 md:gap-x-0">
                            <div class="col-span-6 md:col-span-12">
                                <div class="form-group flex flex-col items-start">
                                    <label class="w-full">
                                        <input x-model="formData.name" class="input input-icon User-input" type="text" id="nameStepId" placeholder="Full Name" name="name" required>
                                    </label>
                                    <small class="self-end text-body2 text-Error mt-1 hidden">Error</small>
                                </div>
                            </div>
                            <div class="col-span-6 md:col-span-12">
                                <div class="form-group flex flex-col items-start">
                                    <label class="w-full">
                                        <input x-model="formData.phone" class="input input-icon Phone-input" type="tel" id="phoneStepId" placeholder="Phone" name="phone" required>
                                    </label>
                                    <small class="self-end text-body2 text-Error mt-1 hidden">Error</small>
                                </div>
                            </div>
                            <div class="col-span-6 md:col-span-12">
                                <div class="form-group flex flex-col items-start">
                                    <label class="w-full">
                                        <input x-model="formData.email" class="input input-icon Mail-input" type="email" id="emailStepId" placeholder="Email" name="email" required>
                                    </label>
                                    <small class="self-end text-body2 text-Error mt-1 hidden">Error</small>
                                </div>
                            </div>
                            <div class="col-span-6 md:col-span-12">
                                <div class="form-group flex flex-col items-start">
                                    <label class="w-full">
                                        <input x-model="formData.zip" class="input input-icon website-input" type="text" id="zipStepId" placeholder="ZIP Code" name="zip" required>
                                    </label>
                                    <small class="self-end text-body2 text-Error mt-1 hidden">Error</small>
                                </div>
                            </div>
                            <div class="col-span-12">
                                <div class="flex flex-col mt-2">
                                    <label class="custom-checkbox">
                                    <span class="custom-checkbox__block w-[18px] min-w-[18px] h-[18px]">
                                        <i class="w-[18px] min-w-[18px] h-[18px] rounded bg-white border border-blue100 flex"></i>
                                    </span>
                                        <input x-model="formData.terms" type="checkbox" name="terms">
                                        <span class="checkmark">
                                         <i class="Checkbox"></i>
                                    </span>
                                        <span class="ml-2 text-body2 text-Grey">I consent to be contacted and i have read and agree to the <a class="text-blue100" href="#">LawyerAI privacy notice</a> and <a class="text-blue100" href="#">terms of service.*</a></span>
                                    </label>
                                    <small class="text-body2 font-medium text-Error md:text-body4 mt-2 hidden">Error</small>
                                </div>
                            </div>
                            <div class="col-span-12">
                                <button @click="handleSubmitStep2" class="button mt-2" aria-label="Let’s talk Button">
                                    <span>Let’s talk</span>
                                    <svg class="ml-2" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10" fill="none">
                                        <path d="M4.88452 0.880859L9.19988 5.00007L4.88452 9.11928" stroke="white" stroke-width="1.28571" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3 (Loading) -->
                <div x-show="step === 3" class="">
                    <div class="flex flex-col">
                        <div class="flex mb-6">
                            <i class="AI-icon-small min-w-[37px] mr-3 mt-1"></i>
                            <div class="flex flex-col">
                                <p class="text-base font-medium mb-2 text-left">Describe a legal project or role and we’ll match you with exceptional legal talent.</p>
                            </div>
                        </div>
                        <div x-data="{ currentVal: 90 ,minVal: 0 ,maxVal: 100, calcPercentage(min, max, val){return ((val-min)/(max-min))*100} }" class="flex h-[9px] w-full overflow-hidden rounded-6xl bg-LightGrey" role="progressbar" aria-label="default progress bar" x-bind:aria-valuenow="currentVal" x-bind:aria-valuemin="minVal" x-bind:aria-valuemax="maxVal">
                            <div class="h-full rounded-xl bg-blue100" x-bind:style="`width: ${calcPercentage(minVal, maxVal, currentVal)}%`"></div>
                        </div>
                        <p class="mt-3 text-center text-body2 text-Grey">Searching Axiom’s bench of legal professionals.</p>
                    </div>
                </div>

                <!-- Step 4 -->
                <div x-show="step === 4 && !error" class="">
                    <div class="flex flex-col">
                        <div class="flex items-center mb-6">
                            <i class="AI-icon-small min-w-[37px] mr-3"></i>
                            <div class="flex flex-col">
                                <p class="text-base font-medium">Are you agree to make your question public?</p>
                            </div>
                        </div>
                        <div class="flex px-4 py-3 bg-LightGrey rounded-lg overflow-hidden gap-x-2">
                            <svg class="min-w-[18px]" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19" fill="none">
                                <path d="M9 0.54541C4.0374 0.54541 0 4.58281 0 9.54541C0 14.508 4.0374 18.5454 9 18.5454C13.9626 18.5454 18 14.508 18 9.54541C18 4.58281 13.9626 0.54541 9 0.54541ZM7.2009 13.5171L3.8592 10.1826L5.13 8.90821L7.1991 10.9737L11.9637 6.20911L13.2363 7.48171L7.2009 13.5171Z" fill="#004ED5"/>
                            </svg>
                            <p class="text-body2 font-medium">If you agree, your question and the Al's answer will be added to our knowledge base to help others facing similar legal issues.If you agree, your question and the Al's answer will be added to our knowledge base to help others facing similar legal issues.If you agree, your question and the Al's answer will be added to our knowledge base to help others facing similar legal issues.</p>
                        </div>
                        <div class="mt-6 mb-8 flex gap-x-3">
                            <a class="button min-w-0" href="#">
                                <span class="">Yes</span>
                            </a>
                            <a class="button disabled min-w-0" href="#">
                                <span class="">No</span>
                            </a>
<!--                            <button @click="window.location.href='/next-page'" class="bg-blue-500 text-white p-2 rounded mr-2">Да</button>-->
<!--                            <button @click="step = 5" class="bg-gray-500 text-white p-2 rounded">Нет</button>-->
                        </div>
                        <div class="flex items-center mb-6">
                            <i class="AI-icon-small min-w-[37px] mr-3"></i>
                            <div class="flex flex-col">
                                <p class="text-base font-medium">Or connect with your local attorney</p>
                            </div>
                        </div>
                        <div class="flex px-4 py-3 bg-LightGrey rounded-lg overflow-hidden gap-x-2">
                            <svg class="min-w-[18px]" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19" fill="none">
                                <path d="M9 0.54541C4.0374 0.54541 0 4.58281 0 9.54541C0 14.508 4.0374 18.5454 9 18.5454C13.9626 18.5454 18 14.508 18 9.54541C18 4.58281 13.9626 0.54541 9 0.54541ZM7.2009 13.5171L3.8592 10.1826L5.13 8.90821L7.1991 10.9737L11.9637 6.20911L13.2363 7.48171L7.2009 13.5171Z" fill="#004ED5"/>
                            </svg>
                            <p class="text-body2 font-medium">Lorem ipsum dolor sit amet concectetur sit amen.Lorem ipsum dolor sit amet concectetur sit amen.</p>
                        </div>
                    </div>
                </div>

                <!-- Error Block -->
                <div x-show="error" class="text-center text-red-500">
                    <p class="mb-4">Ошибка отправки данных. Попробуйте снова.</p>
                    <button @click="handleRetry" class="bg-red-500 text-white p-2 rounded">Вернуться</button>
                </div>

                <!-- Thank You -->
                <div x-show="step === 5" class="text-center">
                    <p class="text-lg font-semibold">Спасибо за участие!</p>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('multiStepForm', () => ({
            step: 1,
            textInput: '',
            formData: {
                text: '',
                name: '',
                phone: '',
                email: '',
                zip: '',
                terms: false
            },
            loading: false,
            error: false,
            handleSubmitStep1() {
                this.formData.text = this.textInput;
                localStorage.setItem('step1', JSON.stringify({ text: this.textInput }));
                this.step = 2;
            },
            handleSubmitStep2() {
                if (!this.formData.terms) {
                    alert('Вы должны принять условия!');
                    return;
                }
                this.loading = true;
                this.error = false;
                setTimeout(() => {
                    axios.post('/api/submit', this.formData)
                        .then(() => {
                            this.step = 4;
                        })
                        .catch(error => {
                            console.error('Ошибка:', error);
                            this.error = true;
                        })
                        .finally(() => {
                            this.loading = false;
                        });
                }, 1000);
                this.step = 3;
            },
            handleRetry() {
                this.error = false;
                this.step = 2;
            }
        }));
    });
</script>